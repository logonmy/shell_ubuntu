/*! ag-ssp 2015-01-20 */
!function(){document.getElementsByClassName||(document.getElementsByClassName=function(a,b){for(var c=(b||document).getElementsByTagName("*"),d=new Array,e=0;e<c.length;e++)for(var f=c[e],g=f.className.split(" "),h=0;h<g.length;h++)if(g[h]==a){d.push(f);break}return d});var scheme="https:"==document.location.protocol?"https":"http",cmgtogo=scheme+"://cm.g.doubleclick.net/pixel?google_nid=agrantcn&google_cm",cmttogo=scheme+"://cms.tanx.com/t.gif?tanx_nid=42756270&tanx_cm",cmbtogo=scheme+"://cm.pos.baidu.com/pixel?dspid=6666724",CM_COOKIE_KEY="__ag_cm_",UID_COOKIE_KEY="ag_fid",chars=["1","2","3","4","5","6","7","8","9","0","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],main_domain_reg=/[-0-9a-z]+\.((com\.cn|net\.cn|org\.cn|gov\.cn)|[a-z]{2,5})($|\/)/gi,genUid=function(){for(var a="",b=0;15>b;b++)a+=chars[Math.floor(Math.random()*chars.length)];return a+="A"},setCookie=function(a,b,c){var d="",e="/",f=new Date;f.setTime(f.getTime()+c);d=window.location.host||window.location.hostname,d=d.match(main_domain_reg),d&&d.length>0&&(d=d[0]),document.cookie=a+"="+b+";expires="+f.toGMTString()+";path="+e+";domain="+d},build_img=function(a,b){var c=document.createElement("IMG");c.src=a,c.style.display="none",c.style.width="0px",c.style.height="0px",document.body.appendChild(c),b&&"function"==typeof b&&b(c)},ag_send=function(a,b){"undefined"!=typeof document.onreadystatechange&&document.readyState?"complete"==document.readyState||"loaded"==document.readyState?build_img(a,b):document.onreadystatechange=function(){("complete"==document.readyState||"loaded"==document.readyState)&&build_img(a,b)}:build_img(a,b)},getCookie=function(a){var b=document.cookie.match(new RegExp("(^| )"+a+"=([^;]*)(;|$)"));return null!=b?unescape(b[2]):null},getRealUid=function(){var a="";return a=getCookie(UID_COOKIE_KEY),a||(a=genUid(),setCookie(UID_COOKIE_KEY,a,31536e7)),a};getCookie("CM_COOKIE_KEY")||"https"==scheme||(setCookie(CM_COOKIE_KEY,(new Date).getTime(),6048e5),ag_send(cmgtogo),ag_send(cmbtogo),ag_send(cmttogo));var agrant_gen_ad_func=function(parent){var agrant_ssp_option=window.agrant_ssp_option||function(){var a=parent.offsetWidth,b=parent.offsetHeight;try{"undefined"!=typeof a&&a||(a=Number(parent.style.width.toLowerCase().replace("px","")),b=Number(parent.style.height.toLowerCase().replace("px","")))}catch(c){console.log(c.message)}return{id:parent.getAttribute("data-agssp-id"),slot:parent.getAttribute("data-agssp-slot"),slot_width:a,slot_height:b}}();this.getFlashVersion=function(){var f="-",n=navigator;if(n.plugins&&n.plugins.length){for(var ii=0;ii<n.plugins.length;ii++)if(-1!=n.plugins[ii].name.indexOf("Shockwave Flash")){f=n.plugins[ii].description.split("Shockwave Flash ")[1];break}}else if(window.ActiveXObject)for(var ii=10;ii>=2;ii--)try{var fl=eval("new ActiveXObject('ShockwaveFlash.ShockwaveFlash."+ii+"');");if(fl){f=ii+".0";break}}catch(e){}return f},this.getBrowserInfo=function(){var a=null;return function(){if(a)return a;a={},a.platform=navigator.platform,a.language=navigator.language||navigator.browserLanguage,a.viewpoint={x:document.body.clientWidth,y:document.body.clientHeight},a.resolution={x:window.screen.width,y:window.screen.height},a.charset=document.charset||document.characterSet,a.flashVersion=encodeURIComponent(this.getFlashVersion());try{a.url=encodeURIComponent(window.top.location.href),a.refurl=encodeURIComponent(window.top.document.referrer)}catch(b){a.url=encodeURIComponent(window.location.href),a.refurl=encodeURIComponent(window.document.referrer)}return a}}(),this.genInfoUrl=function(){var a=this.getBrowserInfo(),b="";return b="l="+a.language,b+="&br="+a.viewpoint.x+"x"+a.viewpoint.y,b+="&sr="+a.resolution.x+"x"+a.resolution.y,b+="&c="+a.charset,b+="&p="+a.platform,b+="&fv="+a.flashVersion,b+="&url="+a.url,b+="&ref="+a.refurl},this.genOptionUrl=function(){var a="";return a="id="+agrant_ssp_option.id,a+="&slot="+agrant_ssp_option.slot,a+="&w="+agrant_ssp_option.slot_width,a+="&h="+agrant_ssp_option.slot_height,a+="&uid="+getRealUid()},this.genShowUrl=function(){return"http://adn.agrantsem.com/agsspshow?"+this.genInfoUrl()+"&"+this.genOptionUrl()},this.getAdInfo=function(a){for(var b=a.offsetLeft,c=a.offsetTop,d=a.offsetParent;null!==d;)b+=d.offsetLeft,c+=d.offsetTop,d=d.offsetParent;return{x:b,y:c}},this.genBody=function(a,b){var c=1,d=this.getBrowserInfo().viewpoint.x,e=this.getBrowserInfo().viewpoint.y,f=this.getAdInfo(a),g=f.x+agrant_ssp_option.slot_width,h=f.y+agrant_ssp_option.slot_height;c=e>=h&&d>=g&&f.x>=0&&f.y>=0?1:0>=h||0>=g||f.x>=d||f.y>=e?0:2;var i=this.genShowUrl()+"&po="+c;return'<iframe id="'+b+'" width="'+agrant_ssp_option.slot_width+'" height="'+agrant_ssp_option.slot_height+'" src="'+i+'" frameborder="0" scrolling="no"></iframe>'}};window.agrant_gen_ad=window.agrant_gen_ad||agrant_gen_ad_func}(),function(){var a=function(a,b){var c=new agrant_gen_ad(a),d=c.genBody(a,"ag_sug_"+b);a.innerHTML=d},b=function(b){this.ads=b||[];for(var c=document.getElementsByClassName("agssp_ad_ins"),d=c.length-this.ads.length,e=0;e<this.ads.length;e++)a(c[e],d+e);this.ads.length=0,this.push=function(){var b=document.getElementsByClassName("agssp_ad_ins");a(b[b.length-1],b.length-1)}};window.agrant_ad_gen=new b(window.agrant_ad_gen)}();